translations = {
    "ru": {
        "greeting": "ÐŸÑ€Ð¸Ð²ÐµÑ‚! Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ ÑÐ·Ñ‹Ðº:",
        "choose_language": "Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ ÑÐ·Ñ‹Ðº:",
        "choose_ui": "Ð¢ÐµÐ¿ÐµÑ€ÑŒ Ð²Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ñ€ÐµÐ¶Ð¸Ð¼ Ð¸Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹ÑÐ°:",
        "choose_role": "Ð˜, Ð½Ð°ÐºÐ¾Ð½ÐµÑ†, Ð²Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð²Ð°ÑˆÑƒ Ñ€Ð¾Ð»ÑŒ:",
        "choose_timezone": "Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ ÑÐ²Ð¾Ð¹ Ñ‡Ð°ÑÐ¾Ð²Ð¾Ð¹ Ð¿Ð¾ÑÑ:",
        "enter_timezone_manual": "Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ ÑÐ²Ð¾Ð¹ Ñ‡Ð°ÑÐ¾Ð²Ð¾Ð¹ Ð¿Ð¾ÑÑ Ð²Ñ€ÑƒÑ‡Ð½ÑƒÑŽ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, Asia/Novosibirsk Ð¸Ð»Ð¸ +06:00):",
        "registration_complete": "Ð ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð°! Ð’Ð¾Ñ‚ Ð²Ð°ÑˆÐµ Ð³Ð»Ð°Ð²Ð½Ð¾Ðµ Ð¼ÐµÐ½ÑŽ:",
        "already_registered": "Ð’Ñ‹ ÑƒÐ¶Ðµ Ð·Ð°Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð¸Ñ€Ð¾Ð²Ð°Ð½Ñ‹. Ð’Ð¾Ñ‚ Ð²Ð°ÑˆÐµ Ð³Ð»Ð°Ð²Ð½Ð¾Ðµ Ð¼ÐµÐ½ÑŽ:",
        "main_menu": "Ð“Ð»Ð°Ð²Ð½Ð¾Ðµ Ð¼ÐµÐ½ÑŽ:",
        "enter_name": "Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð¿Ñ€ÐµÐ¿Ð°Ñ€Ð°Ñ‚Ð°:",
        "enter_dosage": "Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð´Ð¾Ð·Ð¸Ñ€Ð¾Ð²ÐºÑƒ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, 500 Ð¼Ð³):",
        "choose_type": "Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ñ‚Ð¸Ð¿ Ð¿Ñ€Ð¸Ñ‘Ð¼Ð°:",
        "enter_times": "Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ Ð²Ñ€ÐµÐ¼Ñ Ð¿Ñ€Ð¸Ñ‘Ð¼Ð° Ð² Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ðµ Ñ‡Ñ‡:Ð¼Ð¼ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€, 08:30) Ð¸Ð»Ð¸ Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¾ Ñ‡ÐµÑ€ÐµÐ· Ð·Ð°Ð¿ÑÑ‚ÑƒÑŽ:",
        "enter_conditions": "Ð’Ð²ÐµÐ´Ð¸Ñ‚Ðµ ÑƒÑÐ»Ð¾Ð²Ð¸Ñ Ð¿Ñ€Ð¸Ñ‘Ð¼Ð° (Ñ‡ÐµÑ€ÐµÐ· Ð·Ð°Ð¿ÑÑ‚ÑƒÑŽ) Ð¸Ð»Ð¸ Â«Ð½ÐµÑ‚Â»:",
        "choose_skip": "Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð¿Ð¾Ð²ÐµÐ´ÐµÐ½Ð¸Ðµ Ð¿Ñ€Ð¸ Ð¿Ñ€Ð¾Ð¿ÑƒÑÐºÐµ:",
        "med_added": "âœ… ÐŸÑ€ÐµÐ¿Ð°Ñ€Ð°Ñ‚ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾!",
        "nothing_to_cancel": "ÐÐµÑ‡ÐµÐ³Ð¾ Ð¾Ñ‚Ð¼ÐµÐ½ÑÑ‚ÑŒ.",
        "cancelled": "Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¿Ñ€ÐµÐ¿Ð°Ñ€Ð°Ñ‚Ð° Ð¾Ñ‚Ð¼ÐµÐ½ÐµÐ½Ð¾. Ð’Ñ‹ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰ÐµÐ½Ñ‹ Ð² Ð³Ð»Ð°Ð²Ð½Ð¾Ðµ Ð¼ÐµÐ½ÑŽ.",
        "my_meds_empty": "â„¹ï¸ Ð£ Ð²Ð°Ñ Ð¿Ð¾ÐºÐ° Ð½ÐµÑ‚ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð½Ñ‹Ñ… Ð¿Ñ€ÐµÐ¿Ð°Ñ€Ð°Ñ‚Ð¾Ð².",
        "reminder_text": "ðŸ”” ÐŸÐ¾Ñ€Ð° Ð¿Ñ€Ð¸Ð½ÑÑ‚ÑŒ Ð¿Ñ€ÐµÐ¿Ð°Ñ€Ð°Ñ‚: {name} ({dosage}). Ð£ÑÐ»Ð¾Ð²Ð¸Ñ: {conditions}.",
        "took": "âœ… ÐžÑ‚Ð¼ÐµÑ‡ÐµÐ½Ð¾ ÐºÐ°Ðº Â«ÐŸÑ€Ð¸Ð½ÑÐ»Â».",
        "skipped": "âŒ ÐžÑ‚Ð¼ÐµÑ‡ÐµÐ½Ð¾ ÐºÐ°Ðº Â«ÐŸÑ€Ð¾Ð¿ÑƒÑ‰ÐµÐ½Ð¾Â».",
        "sit_taken": "âœ… Ð’Ñ‹ Ð¾Ñ‚Ð¼ÐµÑ‚Ð¸Ð»Ð¸ Ð¿Ñ€Ð¸Ñ‘Ð¼ Ð¿Ñ€ÐµÐ¿Ð°Ñ€Ð°Ñ‚Ð° Â«{name}Â».",
        "settings_title": "âš™ï¸ ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸:",
        "settings_language": "Ð¯Ð·Ñ‹Ðº Ð¸Ð·Ð¼ÐµÐ½Ñ‘Ð½ Ð½Ð° {language}.",
        "settings_ui": "Ð ÐµÐ¶Ð¸Ð¼ Ð¸Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹ÑÐ° ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½ Ð½Ð° {ui_mode}.",
        "settings_role": "Ð Ð¾Ð»ÑŒ Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð° Ð½Ð° {new_role}.",
        "first_register": "Ð¡Ð½Ð°Ñ‡Ð°Ð»Ð° Ð·Ð°Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð¸Ñ€ÑƒÐ¹Ñ‚ÐµÑÑŒ â€“ Ð²Ð²ÐµÐ´Ð¸Ñ‚Ðµ /start",
        "choose_setting": "ÐŸÐ¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°, Ð²Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð¿ÑƒÐ½ÐºÑ‚ Ð¼ÐµÐ½ÑŽ Ð½Ð°ÑÑ‚Ñ€Ð¾ÐµÐº.",
        "profile_unregistered": "â—ï¸ Ð’Ñ‹ Ð½Ðµ Ð·Ð°Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð¸Ñ€Ð¾Ð²Ð°Ð½Ñ‹. Ð¡Ð½Ð°Ñ‡Ð°Ð»Ð° Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ñ‚Ðµ /start.",
        "profile_text": "ðŸ“‹ Ð’Ð°Ñˆ Ð¿Ñ€Ð¾Ñ„Ð¸Ð»ÑŒ:\nâ€¢ Telegram ID: {id}\nâ€¢ Ð¯Ð·Ñ‹Ðº: {lang}\nâ€¢ UI-Ñ€ÐµÐ¶Ð¸Ð¼: {ui}\nâ€¢ Ð Ð¾Ð»ÑŒ: {role}\nâ€¢ Ð§Ð°ÑÐ¾Ð²Ð¾Ð¹ Ð¿Ð¾ÑÑ: {tz}\n",
        "show_meds_prompt": "â„¹ï¸ Ð£ Ð²Ð°Ñ Ð¿Ð¾ÐºÐ° Ð½ÐµÑ‚ Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½Ð½Ñ‹Ñ… Ð¿Ñ€ÐµÐ¿Ð°Ñ€Ð°Ñ‚Ð¾Ð².",
        "welcome_back": "Ð’Ñ‹ ÑƒÐ¶Ðµ Ð·Ð°Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð¸Ñ€Ð¾Ð²Ð°Ð½Ñ‹. Ð’Ð¾Ñ‚ Ð²Ð°ÑˆÐµ Ð³Ð»Ð°Ð²Ð½Ð¾Ðµ Ð¼ÐµÐ½ÑŽ:"
    },
    "en": {
        "greeting": "Hello! Choose language:",
        "choose_language": "Choose language:",
        "choose_ui": "Now choose UI mode:",
        "choose_role": "Finally, choose your role:",
        "choose_timezone": "Choose your time zone:",
        "enter_timezone_manual": "Enter your time zone manually (e.g. Asia/Novosibirsk or +06:00):",
        "registration_complete": "Registration complete! Here is your main menu:",
        "already_registered": "You are already registered. Here is your main menu:",
        "main_menu": "Main menu:",
        "enter_name": "Enter medication name:",
        "enter_dosage": "Enter dosage (e.g. 500 mg):",
        "choose_type": "Choose intake type:",
        "enter_times": "Enter intake time as HH:MM (e.g. 08:30) or multiple separated by commas:",
        "enter_conditions": "Enter intake conditions (comma-separated) or \"none\":",
        "choose_skip": "Choose skip behavior:",
        "med_added": "âœ… Medication added successfully!",
        "nothing_to_cancel": "Nothing to cancel.",
        "cancelled": "Medication addition canceled. You are back to main menu.",
        "my_meds_empty": "â„¹ï¸ You have no added medications yet.",
        "reminder_text": "ðŸ”” Time to take medication: {name} ({dosage}). Conditions: {conditions}.",
        "took": "âœ… Marked as â€œTaken.â€",
        "skipped": "âŒ Marked as â€œSkipped.â€",
        "sit_taken": "âœ… You marked intake of â€œ{name}.â€",
        "settings_title": "âš™ï¸ Settings:",
        "settings_language": "Language changed to {language}.",
        "settings_ui": "UI mode set to {ui_mode}.",
        "settings_role": "Role changed to {new_role}.",
        "first_register": "Please register first â€“ use /start",
        "choose_setting": "Please choose a settings option.",
        "profile_unregistered": "â—ï¸ You are not registered. First use /start.",
        "profile_text": "ðŸ“‹ Your profile:\nâ€¢ Telegram ID: {id}\nâ€¢ Language: {lang}\nâ€¢ UI mode: {ui}\nâ€¢ Role: {role}\nâ€¢ Time zone: {tz}\n",
        "show_meds_prompt": "â„¹ï¸ You have no added medications yet.",
        "welcome_back": "You are already registered. Here is your main menu:"
    }
}

def t(key: str, lang: str, **kwargs) -> str:
    text = translations.get(lang, translations["ru"]).get(key, "")
    return text.format(**kwargs)
